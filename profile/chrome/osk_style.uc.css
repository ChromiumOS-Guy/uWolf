/* osk_style.uc.css */
/* This file imports system-parameters.css. */
/* It's designed to be imported into your main userChrome.css. */

@import "system-parameters.css";

:root {
  position: relative;

  /* Dynamically select the active portrait height based on --is-tablet. */
  --calculated-osk-height-portrait: calc(
    var(--calculated-o-s-kphone-portrait-height) * (1 - var(--is-tablet)) +
    var(--calculated-o-s-ktablet-portrait-height) * var(--is-tablet)
  );

  /* Dynamically select the active landscape height based on --is-tablet. */
  --calculated-osk-height-landscape: calc(
    var(--calculated-o-s-kphone-landscape-height) * (1 - var(--is-tablet)) +
    var(--calculated-o-s-ktablet-landscape-height) * var(--is-tablet) 
  );

  /* New variable to hold the active OSK height. Defaults to portrait. */
  --active-osk-height: calc(var(--calculated-osk-height-portrait) + (max(45px, min(7vh, 120px)) + 1px)); /* we do the calculation for tabbar height here so it reapplies in the two cases it can resize portrait/landscape*/
  
  transition: all 0.2s ease-out !important;
}

/* Adjust the active OSK height for landscape orientation */
@media (orientation: landscape) {
  :root {
    --active-osk-height: calc(var(--calculated-osk-height-landscape) + (max(45px, min(7vh, 120px)) + 1px)); /* we do the calculation for tabbar height here so it reapplies in the two cases it can resize portrait/landscape*/
  }
}

/* * Apply the dynamic height using the single variable.
 * This rule will now work for both portrait and landscape.
 */
:root.osk-input-focused #main-window,
:root.osk-input-focused #browser,
:root.osk-input-focused #appcontent,
:root.osk-input-focused #tab-browser,
:root.osk-input-focused browser[type="content"],
:root.osk-input-focused #content,
:root.osk-input-focused .browserStack
{
  height: var(--active-osk-height) !important;
  max-height: 100% !important;
  flex: 1 1 auto !important;
  overflow-y: hidden !important;
}

/* When OSK is hidden, explicitly ensure no bottom margin */
:root.osk-hidden #main-window,
:root.osk-hidden #browser,
:root.osk-hidden #appcontent,
:root.osk-hidden #tab-browser,
:root.osk-hidden browser[type="content"],
:root.osk-hidden #content,
:root.osk-hidden .browserStack
{
  height: 100% !important;
  max-height: 100% !important;
  flex: 1 1 auto !important;
  overflow-y: auto !important;
}

/* Your overlay styles are correct and do not need to be changed. */
:root.osk-input-focused::before {
  content: "";
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background-color: rgba(0, 0, 0, 0.3);
  z-index: 9999;
  transition: opacity 0.2s ease-out !important;
  opacity: 1;
}

:root:not(.osk-input-focused)::before {
  content: "";
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background-color: transparent;
  z-index: -1;
  pointer-events: none;
  transition: opacity 0.2s ease-out !important;
  opacity: 0;
}